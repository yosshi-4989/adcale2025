# 注意

`Git v2.23`から`checkout`が持っていた機能と同等の機能を持つ`switch`と`restore`の2つのコマンドが出来ました。  
ここでは`checkout`コマンドについて記載しますが、上記のコマンドを利用することを推奨します。

なお、ここでは`switch`と同様の使い方に関しての説明を行います。  
※`switch`コマンドを使ったことが無いので予想ではあります。

# `checkout`コマンド概要

`HEAD`の位置の変更とファイルの操作を行うコマンド。  
`--`オプションでファイル/ディレクトリを指定するとファイル操作になる。
ここでは`--`オプションを利用しない`HEAD`の位置の変更機能について言及する。

`git checkout [<options>] <commit/branch/tag>`で指定したコミットへHEADを移動する。
ブランチ指定が多いが、コミットやタグを指定することもできる。  
ただし、ファイルの差分がある状態で`checkout`をするときに差分のあるファイルが`HEAD`と指定コミットとに差分があるときはコンフリクトの可能性があるため移動できない。

# 前提知識

※この知識は他のコマンドでも必要になるのでもしかしたら別日の項目に移動するかも。

## コミットとブランチ、タグ、`HEAD`の関係

Gitにおけるコードのバージョン管理はコミットを土台としている。  
ブランチとタグはそれぞれのコミットに名前を付けたものと考えて問題ない。  
`HEAD`もブランチやタグと同様で、現在作業中のコミットへのエイリアスになっている。

そのため、`checkout`でコミット、ブランチ、タグなど複数のものを指定できるかのように見えるが、実際はどのコミットで作業します、という宣言をしているだけに過ぎない。
※"コミットを追加する際にどのブランチをそのコミットを参照するように変更するか"などブランチでの操作があるため、
コミット/タグ指定とブランチ指定は厳密には異なるが作業する場所を指定するうえではコミットを指定しているのと変わらないことを伝えたい。

## コミットの相対パス

Gitコマンドを実行するときに、`HEAD^`や`HEAD~`などのように末尾に変な記号を付けた`HEAD`を指定することが有る。  
これは`HEAD`からの相対位置でコミットを指定するときの記法になっている。

`HEAD~`は`HEAD`の一つ前(親)のコミットを指し、`HEAD~2`のように数値指定があるとその分親のコミットを参照する。(例の`HEAD~2`であれば2つ前のコミットを指す。)  
対して`HEAD^`もひとつ前(親)のコミットを指すのは変わらないが、`HEAD^2`のように数値指定がある場合は挙動が変わり、(マージなどで複数の親がある場合に)親の中で何番目の親かを指すようになる。  
`HEAD~`はそれ自体がすでに一つ前のコミットを指すエイリアスになっているので、記号を重ねることでそのコミットからの相対位置を示すことができる。つまり、`HEAD~2=HEAD~~(=HEAD^^)`となる。

個人的には、ずっと`^`を使っているので`HEAD^^^^^`のように指定する(※1)ことがままあるが、MacにインストールされているGitでは使えない(※)のでこれから使うようにするのであれば`~`で覚えるとよいかもしれない。
※1:07の`rebase②`をお楽しみに。
※2:親が複数ある時は使えるかもしれない？

# よく使うオプション

## -b \<new-branch\> [\<base-branch\>]

`new-branch`で指定した名称の新規ブランチを作成するオプション。  
`base-branch`を指定しない場合はHEADのコミットから、指定する場合は指定の(ブランチ/タグ/コミットの)コミットからブランチを作成する。

個人的にはあんまり`base-branch`を指定することはないかな。  
ここから切りたい、ってブランチを最新化してそこからブランチを切るようにしている。  
ローカルブランチもリモートブランチも`fetch`や`pull`などで最新化しておかないと古いコミットからブランチを切ってしまう可能性があるため、一律ローカルを最新にして作成するようにしてる。

# コメント

こっちの機能は新規ブランチを切るか作業ブランチを切り替えるぐらいでしか使わないので特にいうことなし。  
前提知識に書いたコミット周りの話が重要かな。これ1日目に書きたかったなぁ。24日目や25日目にでも記載して、それまでの記事を修正する方向で進めようかな。
